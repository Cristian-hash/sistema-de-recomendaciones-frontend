<div class="container">
  <header>
    <h1>Recomendador de Productos</h1>
    <p class="subtitle">Analizando el historial real para potenciar tus ventas.</p>
  </header>

  <main>
    <!-- 1. Recomendador por Producto (Ya existente) -->
    <!-- 1. Recomendador por Producto (Ya existente) -->
    <section class="search-section">
      <h2 class="section-title">ü§ù Asistente de Venta (Cross-Selling)</h2>
      <p style="color: #94a3b8; margin-bottom: 2rem;">Indica qu√© producto se est√° llevando el cliente y te diremos qu√©
        m√°s ofrecerle.</p>

      <div class="search-input-wrapper">
        <input type="text" placeholder="Ingresa el producto que el cliente va a comprar..." [(ngModel)]="searchTerm"
          (input)="onSearchChange()" (keyup.enter)="onSearchButtonClick()" autocomplete="off">
        <button class="search-button" (click)="onSearchButtonClick()">
          ANALIZAR
        </button>
      </div>

      <div class="results-dropdown" *ngIf="searchResults.length > 0">
        <div class="result-item" *ngFor="let product of searchResults" (click)="selectProduct(product)">
          <span class="result-name">{{ product.nombre }}</span>
          <span class="result-code">{{ product.codigo }}</span>
        </div>
      </div>

      <!-- Resultados Producto -->
      <div class="recommendations-container" *ngIf="selectedProduct">
        <h3 class="sub-title" style="color: #818cf8;">üí° Si el cliente lleva <b>{{ selectedProduct.nombre }}</b>,
          ofr√©cele tambi√©n:</h3>

        <div class="loading-state" *ngIf="loading">
          <p>Analizando patrones de compra...</p>
        </div>

        <div class="products-grid" *ngIf="!loading && recommendations.length > 0">
          <div class="product-card" *ngFor="let rec of recommendations">
            <span class="product-code">{{ rec.codigo }}</span>
            <h3 class="product-name">{{ rec.nombre }}</h3>

            <!-- Sales Tip "Why" -->
            <div class="reason-badge" *ngIf="rec.razon"
              style="background: rgba(16, 185, 129, 0.1); color: #34d399; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; margin-bottom: 0.5rem; display: inline-block;">
              üí° {{ rec.razon }}
            </div>

            <p class="product-desc">{{ rec.descripcion || 'Sin descripci√≥n' }}</p>
            <div class="product-footer">
              <span class="product-price">{{ rec.ecomPrecio | currency:'S/.' }}</span>
            </div>
          </div>
        </div>
      </div>
    </section>


  </main>
</div>